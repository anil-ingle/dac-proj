package com.dac.onlineparking.module.login;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import javax.activation.DataSource;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;

import com.dac.onlineparking.util.DBConnection;
import com.dac.onlineparking.util.UserQuery;

@Repository
public class LoginDAO {
	@Autowired
	private DataSource dataSource;

	public LoginVO login111(String userName, String password) {
		LoginVO vo = new LoginVO();
		try {
			Connection con = DBConnection.getConnection();
			PreparedStatement psmt = con.prepareStatement(UserQuery.LOGIN_USSER);
			// set input param
			psmt.setString(1, registerVO.getEmail());
			psmt.setString(2, registerVO.getPass());

			// execute the query
			ResultSet rs = psmt.executeQuery();
			while (rs.next()) {

				vo.setId(rs.getInt("id"));
				vo.setfName(rs.getString("fname"));
				vo.setlName(rs.getString("lname"));
				vo.setEmail(rs.getString("email"));
				vo.setRoll(rs.getInt("roll"));
				vo.setGender(rs.getString("gender"));
				vo.setMobileNumber(rs.getString("mobileNumber"));
				vo.setTotalAmount(rs.getDouble("totalamount"));

			}
		} catch (SQLException se) {
			se.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		}
		return vo;

	}

	@Override
	public LoginVO login(String userName, String password) {
		LoginVO bo = null;
		bo = jt.queryForObject(GET_EMP_DETAILS_BY_NO, (ResultSet rs, int index) -> {
			EmployeeBO ebo = null;
			ebo = new EmployeeBO();
			// copy record from ResultSet obj to Bo class object
			ebo.setEno(rs.getInt(1));
			ebo.setEname(rs.getString(2));
			ebo.setDesg(rs.getString(3));
			ebo.setSalary(rs.getInt(4));
			return ebo;
		}// mapRow
				, userName, password);
		return bo;
	}// method

}
